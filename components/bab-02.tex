\chapter{REPL dan Dasar-dasar JavaScript di Node.js}

\section{REPL}

REPL adalah lingkungan pemrograman interaktif, tempat developer bisa mengetikkan program per baris dan langsung mengeksekusi hasilnya. Biasanya ini digunakan untuk menguji perintah-perintah yang cukup dijalankan pada satu baris atau satu blok segmen kode sumber saja. Karena fungsinya itu, maka istilah yang digunakan adalah REPL (read-eval-print-loop), yaitu loop atau perulangan baca perintah - evaluasi perintah - tampilkan hasil. REPL sering juga disebut sebagai \textit{interactive top level} atau \textit{language shell}. ``Tradisi'' ini sudah dimulai sejak jaman LISP di mesin UNIX di era awal pengembangan \textit{development tools}. Saat ini hampir semua \textit{interpreter/compiler} mempunyai REPL, misalnya Python, Ruby, Scala, PHP, berbagai interpreter/compiler LISP, dan tidak ketinggalan Node.js. 

\subsection{Mengaktifkan REPL}

Untuk mengaktifkan REPL dari Node.js, \textit{executable command line program}-nya adalah \textbf{node}. Jika \textbf{node} dipanggil dengan argumen nama file JavaScript, maka file JavaScript tersebut akan dieksekusi, sementara jika tanpa argumen, akan masuke ke REPL:

\lstset{language=bash,caption=Node.js REPL}
\begin{lstlisting}
$ node
> .help
.break	Sometimes you get stuck, this gets you out
.clear	Alias for .break
.exit	Exit the repl
.help	Show repl options
.load	Load JS from a file into the REPL session
.save	Save all evaluated commands in this REPL session to a file
>
\end{lstlisting}

Tanda ``\textbf{>}'' adalah tanda bahwa REPL Node.js siap untuk menerima perintah. Untuk melihat perintah-perintah REPL, bisa digunakan \textbf{.help}.

\subsection{Perintah-perintah REPL}

Pada sesi REPL, kita bisa memberikan perintah internal REPL maupun perintah-perintah lain yang sesuai dan dikenali sebagai perintah JavaScript. Perintah internal REPL Node.js terdiri atas:
\begin{itemize}
  \item \textbf{.break}: keluar dan melepaskan diri dari "keruwetan" baris perintah di REPL.
  \item \textbf{.clear}: alias untuk .break
  \item \textbf{.exit}: keluar dari sesi REPL (bisa juga dengan menggunakan Ctrl-D)
  \item \textbf{.help}: menampilkan pertolong perintah internal REPL
  \item \textbf{.load}: membaca dan mengeksekusi perintah-perintah JavaScript yang terdapat pada suatu file.
  \item \textbf{.save}: menyimpan sesi REPL ke dalam suatu file.
\end{itemize}

Contoh untuk \textbf{.load}:

\lstset{language=JavaScript,caption=Contoh penggunaan .load dalam REPL}
\begin{lstlisting}
> .load /home/bpdp/kerjaan/src/javascript/nodejs/server.js
> var http = require('http');
undefined
> http.createServer(function (req, res) {
...     res.writeHead(200, {'Content-Type': 'text/plain'});
...       res.end('Hello, world!\n');
... }).listen(8124, "127.0.0.1");
{ _connections: 0,
  connections: [Getter/Setter],
  allowHalfOpen: true,
  _handle: null,
  _events: 
   { request: [Function],
     connection: [Function: connectionListener] },
  httpAllowHalfOpen: false }
> console.log('Server running at http://127.0.0.1:8124/');
Server running at http://127.0.0.1:8124/
undefined
>
\end{lstlisting}

Setelah keluar dari sesi REPL, maka port akan ditutup dan hasil eksekusi di atas akan dibatalkan. 

Untuk menyimpan hasil sesi REPL menggunakan \textbf{.save}, jika tanpa menyebutkan direktori, maka akan disimpan di direktori aktif saat itu. Contoh:
\lstset{language=bash,caption=Contoh penggunaan perintah .save di sesi REPL}
\begin{lstlisting}
$ node
> console.log("Selamat datang di Node.js")
Selamat datang di Node.js
undefined
> .save /home/bpdp/kerjaan/src/javascript/nodejs/hello.js
Session saved to:/home/bpdp/kerjaan/src/javascript/nodejs/hello.js
> [bpdp@bpdp-arch ~]$ cat /home/bpdp/kerjaan/src/javascript/nodejs/hello.js 
console.log("Selamat datang di Node.js")
\end{lstlisting}

\section{Dasar-dasar JavaScript di Node.js}

Node.js merupakan sistem peranti lunak yang merupakan implementasi dari bahasa pemrograman JavaScript. Spesifikasi JavaScript yang diimplementasikan merupakan spesifikasi resmi dari ECMAScript serta CommonJS (\url{http://commonjs.org}). Dengan demikian, jika anda sudah pernah mempelajari JavaScript sebelumnya, tata bahasa dari perintah yang dipahami oleh Node.js masih tetap sama dengan JavaScript. 

\subsection{Membaca \textit{Masukan} dari Stream / Masukan Standar (stdin)}

Untuk lebih memahami dasar-dasar JavaScript serta penerapannya di Node.js, seringkali kita perlu melakukan simulasi pertanyaan - proses - keluaran jawaban. Proses akan kita pelajari seiring dengan materi-materi berikutnya, sementara untuk keluaran, kita bisa menggunakan \textbf{console.log}. Bagian ini akan menjelaskan sedikit tentang masukan.

Perintah untuk memberi masukan di Node.js sudah tersedia pada pustaka API \textit{Readline}\footnote{Lengkapnya bisa diakses di \url{http://nodejs.org/api/readline.html}}. Pola dari masukan ini adalah sebagai berikut:
\begin{itemize}
  \item me-\textit{require} pustaka Readline
  \item membuat \textit{interface} untuk masukan dan keluaran
  \item .. gunakan interface ..
  \item .. gunakan interface ..
  \item .. gunakan interface ..
  \item .. gunakan interface ..
  \item ..
  \item ..
  \item tutup \textit{interface}
\end{itemize}

Implementasi dari pola diatas bisa dilihat pada kode sumber berikut ini (diambil dari manual Node.js):

\lstset{language=JavaScript,caption=readline.js: penggunaan pustaka Readline untuk masukan}
\begin{lstlisting}
var readline = require('readline');

var rl = readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

rl.question("What do you think of node.js? ", function(answer) {
  console.log("Thank you for your valuable feedback:", answer);

  rl.close();
});
\end{lstlisting}

Hasilnya adalah sebagai berikut:

\lstset{language=bash,caption=Hasil eksekusi readline.js}
\begin{lstlisting}
[bpdp@bpdp-arch modul-2]$ node readline.js 
What do you think of node.js? awesome!
Thank you for your valuable feedback: awesome!
[bpdp@bpdp-arch modul-2]$
\end{lstlisting}


\begin{Sbox}
\begin{minipage}{\textwidth}
\textbf{Catatan:} \textit{function(answer)} pada listing di atas merupakan \textit{anonymous function} atau fungsi anonimus (sering juga disebut \textit{lambda function} / fungsi lambda. Posisi fungsi pada listing tersebut disebut dengan fungsi \textit{callback}. Untuk keperluan pembahasan saat ini, untuk sementara yang perlu dipahami adalah hasil input akan dimasukkan ke \textit{answer} untuk diproses lebih lanjut. Fungsi dan \textit{callback} akan dibahas lebih lanjut pada pembahasan berikutnya.
\end{minipage}
\end{Sbox}
\begin{center}
\shadowbox{\TheSbox}
\end{center}

\subsection{Nilai/Value dan Tipe Data}

Program dalam JavaScript akan berhubungan dengan data atau nilai. Setiap nilai mempunyai tipe tertentu. JavaScript mengenali berbagai tipe berikut ini:
\begin{itemize}
  \item Angka: bulat (misalnya 4) atau pecahan (misalnya 3.75)
  \item \textit{Boolean}: nilai benar (true) dan salah (false)
  \item String: diapit oleh tanda petik ganda ("contoh string") atau tunggal ('contoh string')
  \item \textit{null}
  \item \textit{undefined}
\end{itemize}

JavaScript adalah bahasa pemrograman yang mengijinkan pemrogram untuk tidak mendefinisikan tipe data pada saat deklarasi, atau sering juga disebut sebagai \textit{dynamically typed language}:

\lstset{language=JavaScript,caption=Fitur \textit{dynamically typed language}}
\begin{lstlisting}
var jumlahMahasiswa = 30
console.log('Jumlah mahasiswa dalam satu kelas = ' + jumlahMahasiswa);
// Jumlah mahasiswa dalam satu kelas = 30
\end{lstlisting} 

Pada contoh di atas, kita bisa melihat bahwa data akan dikonversi secara otomatis pada saat program dieksekusi.

\begin{Sbox}
\begin{minipage}{\textwidth}
\textbf{Catatan:}
\begin{itemize}
  \item Khusus untuk operator "+", JavaScript akan melakukan penggabungan string (\textit{string concatenation}), tetapi untuk operator lain, akan dilakukan operasi matematis sesuai operator tersebut (-,/,*).
  \item Konversi string ke tipe numerik bisa dilakukan dengan \textit{parseInt(string)} (jika bilangan bulat) dan \textit{parseFloat(string)} (jika bilangan pecahan).
\end{itemize}
\end{minipage}
\end{Sbox}
\begin{center}
\shadowbox{\TheSbox}
\end{center}

\subsection{Variabel}

Variabel adalah suatu nama yang didefinisikan untuk menampung suatu nilai. Nama ini akan digunakan sebagai referensi yang akan menunjukkan ke nilai yang ditampungnya. Nama variabel disebut dengan \textit{identifier} / pengenal. Ada beberapa syarat pemberian nama \textit{identifier} di JavaScript: 
\begin{itemize}
  \item Dimulai dengan huruf, \textit{underscore} (\_), atau tanda dollar (\$).
  \item Karakter berikutnya bisa berupa angka, selain ketentuan pertama di atas.
  \item Membedakan huruf besar - kecil.
\end{itemize}
Konvensi yang digunakan oleh pemrogram JavaScript terkait dengan penamaan ini adalah variasi dari metode \textit{camel case}, yaitu \textit{camelBack}. Contoh: jumlahMahasiswa, linkMenu.

\subsection{Literal}


\subsection{Aliran Kendali}

\subsection{Fungsi}

\subsection{Penanganan Error}

\subsection{Struktur Data dan Representasi JSON}

